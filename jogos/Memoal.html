<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>RealMind ‚Äî Memoal v2</title>
<style>
  :root{
    --bg1:#0ea5e9; --bg2:#1e3a8a; --glass:#ffffff16; --glass2:#ffffff22; --ink:#fff;
    --ok:#22c55e; --bad:#ef4444; --muted:#dbeafe;
    /* Paleta com alto contraste + acessibilidade (cada cor tem uma forma distinta) */
    --c-azul:#2563eb;    /* ‚óè c√≠rculo */
    --c-verde:#16a34a;   /* ‚ñ† quadrado */
    --c-laranja:#ea580c; /* ‚ñ≤ tri√¢ngulo */
    --c-roxo:#7c3aed;    /* ‚óÜ losango */
    --c-verm:#dc2626;    /* ‚òÖ estrela */
    --tile:#0b1020;
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100dvh; color:var(--ink);
    font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans";
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    display:flex; align-items:center; justify-content:center; padding:16px;
  }
  .app{ width:min(980px,100%); }
  header{ text-align:center; margin-bottom:8px }
  h1{ margin:0 0 4px; font-size:clamp(22px,5vw,36px) }
  .sub{ opacity:.9; font-size:clamp(14px,3.2vw,18px) }

  .panel{
    background:var(--glass);
    border:1px solid #ffffff26; border-radius:18px; padding:14px;
    box-shadow:0 18px 40px #0006; backdrop-filter: blur(6px);
  }
  .hud{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-bottom:10px }
  .kpi{ min-width:110px; text-align:center; background:#0000002a; border:1px solid #ffffff22; border-radius:14px; padding:10px }
  .kpi .lbl{ font-size:14px; opacity:.85 }
  .kpi .val{ font-size:22px; font-weight:800; margin-top:2px }

  .prompt{
    text-align:center; background:#0000002a; border:1px solid #ffffff22;
    padding:12px; border-radius:14px; margin-bottom:12px; font-weight:700; font-size:18px;
  }
  .legend{ display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-bottom:8px }
  .chip{ display:inline-flex; align-items:center; gap:10px; padding:8px 12px; border-radius:999px; border:1px solid #ffffff22; background:#00000026; font-size:16px }
  .shape{ font-weight:900; font-size:22px }

  .wrap{ display:flex; justify-content:center }
  .board{
    width:min(92vw,640px); aspect-ratio:1/1;
    display:grid; gap:10px;
  }
  .tile{
    position:relative; border-radius:16px; border:1px solid #ffffff22; overflow:hidden;
    background:linear-gradient(180deg,#0b1020,#0b1020 60%,#0a1328);
    display:grid; place-items:center; box-shadow: inset 0 8px 30px #0008;
    cursor:pointer; transition:transform .08s ease, border-color .2s ease;
  }
  .tile:active{ transform:scale(.98) }
  .symbol{
    font-size:clamp(28px,6.5vw,46px); font-weight:900; line-height:1;
    text-shadow:0 0 22px #0008;
  }
  .cover{
    position:absolute; inset:0; background:linear-gradient(120deg,#ffffff14,#00000055);
    border-radius:16px; transition: opacity .35s ease;
  }
  .hidden{ opacity:0 }

  .btns{ display:flex; gap:8px; justify-content:center; margin-top:12px; flex-wrap:wrap }
  button{ all:unset; cursor:pointer; padding:12px 16px; border-radius:999px; font-weight:800; font-size:16px }
  .primary{ background:linear-gradient(90deg,#22d3ee,#3b82f6); color:#06223b }
  .ghost{ background:#0000002e; border:1px solid #ffffff26 }
  .danger{ background:linear-gradient(90deg,#fb7185,#ef4444); color:#3b0710 }
  .success{ background:linear-gradient(90deg,#34d399,#10b981); color:#052418 }

  .muted{ opacity:.8 }
  .center{ text-align:center }
  .ok{ outline:3px solid var(--ok); }
  .bad{ outline:3px solid var(--bad); }

  .overlay{ position:fixed; inset:0; display:none; place-items:center; background:#0009; padding:16px }
  .overlay.show{ display:grid }
  .modal{ width:min(560px,100%) }
</style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Memoal</h1>
      <div class="sub">Treino de mem√≥ria visual e espacial ‚Äî **calmo, claro e sem pressa**.</div>
    </header>

    <div class="panel">
      <div class="hud">
        <div class="kpi"><div class="lbl">N√≠vel</div><div class="val" id="k-level">1</div></div>
        <div class="kpi"><div class="lbl">Pontos</div><div class="val" id="k-score">0</div></div>
        <div class="kpi"><div class="lbl">Recorde</div><div class="val" id="k-best">0</div></div>
        <div class="kpi"><div class="lbl">Vidas</div><div class="val" id="k-lives">üíôüíôüíô</div></div>
      </div>

      <div id="prompt" class="prompt">Toque em <b>Come√ßar</b>. Voc√™ ver√° posi√ß√µes por alguns segundos; depois toque na casa onde estava a cor solicitada. Sem pressa.</div>
      <div id="legend" class="legend"></div>

      <div class="wrap">
        <div id="board" class="board" style="grid-template-columns:repeat(3,1fr)"></div>
      </div>

      <div class="btns">
        <button id="startBtn" class="primary">Come√ßar</button>
        <button id="helpBtn" class="ghost">Ajuda</button>
        <button id="restartBtn" class="danger" style="display:none">Reiniciar</button>
      </div>
    </div>
  </div>

  <!-- Ajuda -->
  <div id="help" class="overlay">
    <div class="modal">
      <div class="panel">
        <h2 style="margin:0 0 8px">Como jogar (modo calmo)</h2>
        <ul style="margin:0 0 12px 18px; line-height:1.6; font-size:18px">
          <li>Memorize as pe√ßas grandes e coloridas por alguns segundos.</li>
          <li>Quando ocultar, leia o pedido (ex.: <b>‚óè Azul</b>) e toque a <b>casa correta</b>.</li>
          <li>Sem cron√¥metro vis√≠vel e com transi√ß√µes suaves. Voc√™ tem <b>3 vidas</b>.</li>
        </ul>
        <p class="muted">Dica: use os cantos e o centro como √¢ncoras visuais. Cores + formas ajudam a fixar.</p>
        <div class="btns center">
          <button id="closeHelp" class="success">Entendi</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Game Over -->
  <div id="over" class="overlay">
    <div class="modal">
      <div class="panel center">
        <h2 style="margin:0 0 6px">Fim de jogo</h2>
        <p style="margin:6px 0">Pontua√ß√£o: <b id="finalScore">0</b></p>
        <p class="muted" style="margin:0 0 14px">Recorde: <b id="finalBest">0</b></p>
        <div class="btns center">
          <button id="againBtn" class="success">Jogar de novo</button>
        </div>
      </div>
    </div>
  </div>

<script>
(()=>{
  // ===== Paleta com forma distinta para cada cor (acessibilidade) =====
  const ITEMS = [
    {label:'Azul',   color:getCSS('--c-azul'),   shape:'‚óè'},
    {label:'Verde',  color:getCSS('--c-verde'),  shape:'‚ñ†'},
    {label:'Laranja',color:getCSS('--c-laranja'),shape:'‚ñ≤'},
    {label:'Roxo',   color:getCSS('--c-roxo'),   shape:'‚óÜ'},
    {label:'Vermelho',color:getCSS('--c-verm'),  shape:'‚òÖ'},
  ];

  const $ = s=>document.querySelector(s);
  const $board = $('#board'), $prompt = $('#prompt'), $legend = $('#legend');
  const $lvl = $('#k-level'), $score = $('#k-score'), $best = $('#k-best'), $lives = $('#k-lives');
  const $start = $('#startBtn'), $restart = $('#restartBtn'), $help = $('#helpBtn');
  const $ovHelp = $('#help'), $closeHelp = $('#closeHelp');
  const $over = $('#over'), $again = $('#againBtn'), $finalScore = $('#finalScore'), $finalBest = $('#finalBest');

  let S = {
    level:1, score:0, best: parseInt(localStorage.getItem('memoal_best')||'0',10),
    lives:3, grid:3, count:3, memorizeMs:3500,
    items:[], target:null, running:false, lock:true,
  };
  $best.textContent = S.best;

  function getCSS(name){ return getComputedStyle(document.documentElement).getPropertyValue(name).trim(); }
  function setGrid(n){ S.grid=n; $board.style.gridTemplateColumns = `repeat(${n},1fr)`; }
  function setLives(n){ S.lives=n; $lives.textContent = n>0 ? 'üíô'.repeat(n) : '‚Äî'; }
  function setPrompt(txt){ $prompt.innerHTML = txt; }
  function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]] } return a }
  function rand(arr){ return arr[Math.floor(Math.random()*arr.length)] }

  function tune(){
    // Cresce devagar e SEM pressa
    if(S.level<=2){ setGrid(3); S.count=3; S.memorizeMs=3800; }
    else if(S.level<=4){ setGrid(4); S.count=4; S.memorizeMs=3600; }
    else if(S.level<=6){ setGrid(4); S.count=5; S.memorizeMs=3400; }
    else { setGrid(5); S.count=6; S.memorizeMs=3200; }
  }

  function buildBoard(reveal=false){
    $board.innerHTML='';
    const total = S.grid*S.grid;
    for(let i=0;i<total;i++){
      const b = document.createElement('button');
      b.className='tile';
      b.dataset.idx=i;

      const sym = document.createElement('div'); sym.className='symbol';
      const found = S.items.find(it=>it.pos===i);
      if(found){
        sym.textContent = found.shape;
        sym.style.color = found.color;
      }else{
        sym.textContent = '';
      }

      const cover = document.createElement('div'); cover.className='cover';
      if(reveal) cover.classList.add('hidden');

      b.append(sym, cover);
      $board.appendChild(b);
    }
  }

  function place(){
    const total = S.grid*S.grid;
    const pos = shuffle([...Array(total).keys()]).slice(0,S.count);
    const bag = shuffle([...ITEMS]);
    S.items = pos.map((p,i)=>({pos:p, ...bag[i % bag.length]}));
    S.target = rand(S.items);
    // legenda (alvo)
    $legend.innerHTML='';
    const chip = document.createElement('div');
    chip.className='chip';
    chip.innerHTML = `<span class="shape" style="color:${S.target.color}">${S.target.shape}</span> <b>${S.target.label}</b>`;
    $legend.appendChild(chip);
  }

  function memorizePhase(){
    S.lock=true;
    place();
    buildBoard(true);
    setPrompt('Memorize as posi√ß√µes. <span class="muted">(respire fundo)</span>');
    setTimeout(hidePhase, S.memorizeMs);
  }

  function hidePhase(){
    [...$board.children].forEach(t=>t.querySelector('.cover').classList.remove('hidden'));
    ask();
  }

  function ask(){
    S.lock=false;
    setPrompt(`Onde estava: <b><span class="shape" style="color:${S.target.color}">${S.target.shape}</span> ${S.target.label}</b>? Toque na casa correta.`);
  }

  function handlePick(idx){
    if(S.lock || !S.running) return;
    S.lock=true;
    const i = Number(idx);
    const ok = (i === S.target.pos);

    // feedback visual
    [...$board.children].forEach(tile=>{
      const ii = Number(tile.dataset.idx);
      if(ii === S.target.pos){
        tile.querySelector('.cover').classList.add('hidden'); // revela apenas o correto
        tile.classList.add('ok');
      }
      if(ii === i && !ok){ tile.classList.add('bad'); }
    });

    if(ok){
      const add = 12 + S.level*3;
      S.score += add; $score.textContent = S.score;
      setPrompt(`Perfeito! +${add} pontos. Continue no seu ritmo.`);
      setTimeout(nextRound, 900);
    }else{
      setLives(S.lives-1);
      setPrompt('N√£o foi dessa vez. Observe onde estava e vamos seguir com calma.');
      if(S.lives<=0){ return setTimeout(gameOver, 1100); }
      // leve desacelera√ß√£o ap√≥s erro
      S.level = Math.max(1, S.level-1);
      setTimeout(nextRound, 1200);
    }
  }

  function nextRound(){
    S.level++; $lvl.textContent = S.level;
    tune(); memorizePhase();
  }

  function startGame(){
    S.running=true; S.level=1; S.score=0; S.lives=3;
    $lvl.textContent=1; $score.textContent=0; setLives(3);
    $restart.style.display='inline-block';
    tune(); memorizePhase();
  }

  function gameOver(){
    S.running=false;
    S.best = Math.max(S.best, S.score);
    localStorage.setItem('memoal_best', String(S.best));
    $best.textContent = S.best;
    $finalScore.textContent = S.score;
    $finalBest.textContent = S.best;
    $over.classList.add('show');
  }

  // ==== events ====
  $board.addEventListener('click', e=>{
    const b = e.target.closest('.tile'); if(!b) return;
    handlePick(b.dataset.idx);
  });

  $start.addEventListener('click', startGame);
  $restart.addEventListener('click', startGame);

  $help.addEventListener('click', ()=> $ovHelp.classList.add('show'));
  $closeHelp.addEventListener('click', ()=> $ovHelp.classList.remove('show'));

  $again.addEventListener('click', ()=>{
    $over.classList.remove('show'); startGame();
  });

  // init
  setGrid(3); buildBoard(false); setLives(3);
})();
</script>
</body>
</html>
